function supportsHtmlStorage(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}}function get_text(a){ret=" ";for(var b=a.childNodes.length,c=0;b>c;c++){var d=a.childNodes[c];8!=d.nodeType&&(ret+=1!=d.nodeType?d.nodeValue:get_text(d))}return ret.trim()}!function(a){"use strict";function b(b,c){var d=a.createEvent("Event");d.initEvent(b,!0,!1),c.dispatchEvent(d)}function c(c){a[i.enabled]=a[e.enabled],a[i.element]=a[e.element],b(i.events.change,c.target)}function d(a){b(i.events.error,a.target)}var e,f,g=!0,h={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}}},i=h.w3;for(f in h)if(h[f].enabled in a){e=h[f];break}return!g||i.enabled in a||!e||(a.addEventListener(e.events.change,c,!1),a.addEventListener(e.events.error,d,!1),a[i.enabled]=a[e.enabled],a[i.element]=a[e.element],a[i.exit]=a[e.exit],Element.prototype[i.request]=function(){return this[e.request].apply(this,arguments)}),e}(document),String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var ui=function(){function a(){d(),wordCountActive=!1,supportsHtmlStorage()&&b(),console.log("Checkin under the hood eh? We've probably got a lot in common. You should totally check out ZenPen on github! (https://github.com/tholman/zenpen).")}function b(){localStorage.wordCount&&"0"!==localStorage.wordCount&&(B=parseInt(localStorage.wordCount),D.value=localStorage.wordCount,E.className="word-counter active",p()),"true"===localStorage.darkLayout&&(document.body.className=I===!1?"yang":"yin",I=!I)}function c(){supportsHtmlStorage()&&(localStorage.darkLayout=I,localStorage.wordCount=D.value)}function d(){s=document.body,u=document.querySelector(".ui"),z=document.querySelector(".color-flip"),z.onclick=h,y=document.querySelector(".fullscreen"),y.onclick=e,A=document.querySelector(".target "),A.onclick=i,document.addEventListener("fullscreenchange",function(){document.fullscreenEnabled===!1&&g()},!1),v=document.querySelector(".overlay"),v.onclick=q,t=document.querySelector(".content"),t.onkeyup=o,C=v.querySelector(".wordcount"),D=C.querySelector("input"),D.onchange=m,D.onkeyup=l,x=v.querySelector(".description"),E=document.querySelector(".word-counter"),F=E.querySelector(".progress"),w=document.querySelector(".about"),w.onclick=j,header=document.querySelector(".header"),header.onkeypress=k}function e(){document.fullscreenEnabled===!1?f():g()}function f(){document.body.requestFullscreen(Element.ALLOW_KEYBOARD_INPUT),y.innerHTML=H}function g(){document.exitFullscreen(),y.innerHTML=G}function h(){document.body.className=I===!1?"yang":"yin",I=!I,c()}function i(){v.style.display="block",C.style.display="block",D.focus()}function j(){v.style.display="block",x.style.display="block"}function k(a){13===a.keyCode&&(a.preventDefault(),t.focus())}function l(a){13===a.keyCode&&(a.preventDefault(),n(parseInt(this.value)),r(),t.focus())}function m(){n(parseInt(this.value))}function n(a){a>0?(B=a,E.className="word-counter active",p()):(B=0,E.className="word-counter"),c()}function o(){B>0&&p()}function p(){var a=editor.getWordCount(),b=a/B;F.style.height=100*b+"%",F.className=b>=1?"progress complete":"progress"}function q(a){"overlay"===a.target.className&&r()}function r(){v.style.display="none",C.style.display="none",x.style.display="none"}var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G="&#xe006;",H="&#xe005;",I=!1;return{init:a}}(),editor=function(){function a(){lastRange=0,c();var a=document.createRange(),d=window.getSelection();a.setStart(t,1),d.removeAllRanges(),d.addRange(a),b(),supportsHtmlStorage()&&j()}function b(){document.onkeyup=supportsHtmlStorage()?function(a){d(a),i()}:d,document.onmousedown=d,document.onmouseup=function(a){setTimeout(function(){d(a)},1)}}function c(){t=document.querySelector(".header"),u=document.querySelector(".content"),x=document.querySelector(".text-options"),y=x.querySelector(".options"),z=x.querySelector(".bold"),z.onclick=k,A=x.querySelector(".italic"),A.onclick=l,B=x.querySelector(".quote"),B.onclick=m,C=x.querySelector(".url"),C.onmousedown=n,D=x.querySelector(".url-input"),D.onblur=p,D.onkeydown=o}function d(a){var b=window.getSelection();if("url-input"===a.target.className||a.target.classList.contains("url")||a.target.parentNode.classList.contains("ui-inputs"))return w=g(b.focusNode),e(),void 0;if(b.isCollapsed===!0&&v===!1&&f(),b.isCollapsed===!1&&(w=g(b.focusNode),h(w,"ARTICLE"))){var c=b.getRangeAt(0),d=c.getBoundingClientRect();e(),x.className="text-options active",x.style.top=d.top-5+document.body.scrollTop+"px",x.style.left=(d.left+d.right)/2+"px"}v=b.isCollapsed}function e(){z.className=h(w,"B")?"bold active":"bold",A.className=h(w,"I")?"italic active":"italic",B.className=h(w,"BLOCKQUOTE")?"quote active":"quote",C.className=h(w,"A")?"url useicons active":"url useicons"}function f(){x.className="text-options fade",setTimeout(function(){"text-options fade"==x.className&&(x.className="text-options",x.style.top="-999px",x.style.left="-999px")},260)}function g(a){for(var b={};a.parentNode;)b[a.nodeName]=!0,a=a.parentNode,"A"===a.nodeName&&(b.url=a.href);return b}function h(a,b){return!!a[b]}function i(){localStorage.header=t.innerHTML,localStorage.content=u.innerHTML}function j(){localStorage.header&&(t.innerHTML=localStorage.header),localStorage.content&&(u.innerHTML=localStorage.content)}function k(){document.execCommand("bold",!1)}function l(){document.execCommand("italic",!1)}function m(){var a=g(window.getSelection().focusNode);h(a,"BLOCKQUOTE")?document.execCommand("formatBlock",!1,"p"):document.execCommand("formatBlock",!1,"blockquote")}function n(){"options"==y.className?(y.className="options url-mode",setTimeout(function(){var a=g(window.getSelection().focusNode);h(a,"A")?D.value=a.url:document.execCommand("createLink",!1,"/"),lastSelection=window.getSelection().getRangeAt(0),v=!1,D.focus()},10)):y.className="options"}function o(a){13===a.keyCode&&(a.preventDefault(),q(D.value),D.blur())}function p(){y.className="options",q(D.value),D.value="",w=g(window.getSelection().focusNode),e()}function q(a){r(),document.execCommand("unlink",!1),""!==a&&document.execCommand("createLink",!1,a)}function r(){window.getSelection().addRange(lastSelection)}function s(){var a=get_text(u);return""===a?0:a.split(/\s+/).length}var t,u,v,w,x,y,z,A,B,C,D;return{init:a,saveState:i,getWordCount:s}}();