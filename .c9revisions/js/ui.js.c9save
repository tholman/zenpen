{"ts":1359551529242,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var ui = (function() {\n\n\tvar body, screenSizeElement, colorLayoutElement, shareElement, targetElement, overlay, shareText, shareBox, aboutButton;\n\n\tvar article, wordCountValue, wordCountBox, wordCountElement, wordCounter, wordCounterProgress;\n\n\tvar expandScreenIcon = '&#xe006;';\n\tvar shrinkScreenIcon = '&#xe005;';\n\n\tvar darkLayout = false;\n\n\tfunction init() {\n\t\t\n\t\tbindElements();\n\n\t\twordCountActive = false;\n\n\t\tif ( supportsHtmlStorage() && isCleanSlate() ) {\n\t\t\tloadState();\n\t\t}\n\n\t\tconsole.log( \"Checkin out the source eh? We've probably got a lot in common. You should follow me on twitter - http://twitter.com/twholman\" );\n\t}\n\n\tfunction loadState() {\n\n\t\t// Activate word counter\n\t\tif ( localStorage['wordCount'] && localStorage['wordCount'] !== \"0\") {\t\t\t\n\t\t\twordCountValue = parseInt(localStorage['wordCount']);\n\t\t\twordCountElement.value = localStorage['wordCount'];\n\t\t\twordCounter.className = \"word-counter active\";\n\t\t\tupdateWordCount();\n\t\t}\n\n\t\t// Activate color switch\n\t\tif ( localStorage['darkLayout'] === 'true' ) {\n\t\t\tif ( darkLayout === false ) {\n\t\t\t\tdocument.body.className = 'yang';\n\t\t\t} else {\n\t\t\t\tdocument.body.className = 'yin';\n\t\t\t}\n\t\t\tdarkLayout = !darkLayout;\n\t\t}\n\n\t}\n\n\tfunction saveState() {\n\t\t\n\t\tlocalStorage[ 'darkLayout' ] = darkLayout;\n\t\tlocalStorage[ 'wordCount' ] = wordCountElement.value;\n\t}\n\n\tfunction bindElements() {\n\n\t\t// Body element for light/dark styles\n\t\tbody = document.body;\n\n\t\t// UI element for color flip\n\t\tcolorLayoutElement = document.querySelector( '.color-flip' );\n\t\tcolorLayoutElement.onclick = onColorLayoutClick;\n\n\t\t// UI element for full screen\n\t\tscreenSizeElement = document.querySelector( '.fullscreen' );\n\t\tscreenSizeElement.onclick = onScreenSizeClick;\n\n\t\ttargetElement = document.querySelector( '.target ');\n\t\ttargetElement.onclick = onTargetClick;\n\n\t\tdocument.addEventListener( \"fullscreenchange\", function () {\n    \t\tif ( document.fullscreenEnabled === false ) {\n    \t\t\texitFullscreen();\n    \t\t}\n\t\t}, false);\n\n\t\t// UI elements for save/share\n\t\tshareElement = document.querySelector( '.link' );\n\t\tshareElement.onclick = onShareClick;\n\n\t\t// Overlay when modals are active\n\t\toverlay = document.querySelector( '.overlay' );\n\t\toverlay.onclick = onOverlayClick;\n\n\t\tshareText = overlay.querySelector( 'input' );\n\t\tshareBox = overlay.querySelector( '.share' );\n\n\t\tarticle = document.querySelector( '.content' );\n\t\tarticle.onkeyup = onArticleKeyUp;\n\n\t\twordCountBox = overlay.querySelector( '.wordcount' );\n\t\twordCountElement = wordCountBox.querySelector( 'input' );\n\t\twordCountElement.onchange = onWordCountChange;\n\n\t\twordCounter = document.querySelector( '.word-counter' );\n\t\twordCounterProgress = wordCounter.querySelector( '.progress' );\n\n\t\taboutButton = document.querySelector( '.about' );\n\t\taboutButton.onclick = onAboutButtonClick;\n\t}\n\n\tfunction onScreenSizeClick( event ) {\n\n\t\tif ( document.fullscreenEnabled === false ) {\n\t\t\tenterFullscreen();\n\t\t} else {\n\t\t\texitFullscreen();\n\t\t}\n\t}\n\n\tfunction enterFullscreen() {\n\t\tdocument.body.requestFullscreen( Element.ALLOW_KEYBOARD_INPUT );\n\t\tscreenSizeElement.innerHTML = shrinkScreenIcon;\t\n\t}\n\n\tfunction exitFullscreen() {\n\t\tdocument.exitFullscreen();\n\t\tscreenSizeElement.innerHTML = expandScreenIcon;\t\n\t}\n\n\tfunction onColorLayoutClick( event ) {\n\t\tif ( darkLayout === false ) {\n\t\t\tdocument.body.className = 'yang';\n\t\t} else {\n\t\t\tdocument.body.className = 'yin';\n\t\t}\n\t\tdarkLayout = !darkLayout;\n\t\tsaveState();\n\t}\n\n\tfunction onTargetClick( event ) {\n\t\toverlay.style.display = \"block\";\n\t\twordCountBox.style.display = \"block\";\n\t}\n\n\tfunction onAboutButtonClick( event ) {\n\t\twindow.open( 'http://www.zenpen.io/index.html#4+IEgvDUnOT83FSFknyFqNS8gNQ8AA==#nVRNb9QwED3TXzHKhcvuRoBQRUkjOADdG4eeuDnJZD3U9gR73G366xknbVUOSNtGOTj+eH7z3pucnb3Rp5naJk0mQJLZ4WXlKODWIh2sXMD7893H6e5z1V7RBvZvPTTUNgZ6DoL6DiSmK4dG4xJWYCOOl5UVmS7qWiw7b8KuZ1+11+ThavluatM2NbWwhV8YfmIASmDAkYhDOCLeYBhgivwbe9mAMKQ+GumtbhrxCKRDTLAHa251P4kFzwPGAIJ3AoUTx7SDr4riOSJMJgr12ZnoZjigCIUDUFBgsUbgGGmZueeAu6YuUig/FeUkXfYC3twonweYBGjSvLC2JuIGjNLAW61S5wljWekjGnnVXUmV95NDQS3lJB+SGnFQjXJXfHj0pL7HMGGoWrWTdQCJc+wROMCPdXNxqDgF3xEdjBFxYa73ReqyaGEpd54Euqw1c4SIfzImUYuM5Ijp5eVdW4ScVCK8mzASBiVkTYIOS0ZCmijiAN2sOTg1gj4OzGvlD4FKtRXv1pDUVVvyrKF6qvY1mnaOD/W7D+eftqrq9iEH25LJRd+e2b0MvxDX5ezX1lEMJT9kJf+EU1IlqhcpmnaPpnyM7GGvB5jDK6I1wsx5bSkTZli8JMXeFG8V1SvltOzpFSunbNzaTeqGZmoAHsEj3NIJ5nhDTvhCyLPYeXfcraH8cigLa83Fl2/lEx5LVhoK/O8PRptfMK7BPq4g1f/uXiCv1xOPmM91Ois/w78=' );\n\t}\n\n\tfunction onWordCountChange( event ) {\n\n\t\t// Set wordcount ui to active\n\t\tif ( parseInt(this.value) > 0) {\n\t\t\twordCountValue = parseInt(this.value);\n\t\t\twordCounter.className = \"word-counter active\";\n\t\t\tupdateWordCount();\n\t\t} else {\n\t\t\twordCountValue = 0;\n\t\t\twordCounter.className = \"word-counter\";\n\t\t}\n\t\tsaveState();\n\t}\n\n\tfunction onArticleKeyUp( event ) {\n\n\t\tif ( wordCountValue > 0 ) {\n\t\t\tupdateWordCount();\n\t\t}\n\t}\n\n\tfunction updateWordCount() {\n\n\t\tvar wordCount = editor.getWordCount();\n\t\tvar percentageComplete = wordCount / wordCountValue;\n\t\twordCounterProgress.style.height = percentageComplete * 100 + '%';\n\n\t\tif ( percentageComplete >= 1 ) {\n\t\t\twordCounterProgress.className = \"progress complete\";\n\t\t} else {\n\t\t\twordCounterProgress.className = \"progress\";\n\t\t}\n\t}\n\n\tfunction onOverlayClick( event ) {\n\n\t\tif ( event.target.className === \"overlay\" ) {\n\t\t\toverlay.style.display = \"none\";\n\t\t\tshareBox.style.display = \"none\";\n\t\t\twordCountBox.style.display = \"none\";\n\t\t}\n\t}\n\n\tfunction onShareClick() {\n\n\t\tshareText.value = window.location.href.split('#')[0] + '#' + editor.deflate();\n\t\toverlay.style.display = \"block\";\n\t\tshareBox.style.display = \"block\";\n\t\tshareText.focus();\n   \t\tshareText.select();\n\t}\n\n\treturn {\n\t\tinit: init\n\t}\n\n})();"]],"start1":0,"start2":0,"length1":0,"length2":5640}]],"length":5640}
