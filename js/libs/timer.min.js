!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.Timer=b()}(this,function(){"use strict";var a={tick:1,onstart:null,ontick:null,onpause:null,onstop:null,onend:null},b=function(c){if(!(this instanceof b))return new b(c);this._={id:+new Date,options:{},duration:0,status:"initialized",start:0,measures:[]};for(var d in a)this._.options[d]=a[d];this.options(c)};return b.prototype.start=function(b){var c=this;return+b||this._.duration?(b*=1e3,this._.timeout&&"started"===this._.status?this:(this._.duration||(this._.duration=b),this._.timeout=setTimeout(function(){c._end.call(c)},this._.duration),this._.options.ontick!==a.ontick&&(this._.interval=setInterval(function(){c._trigger("ontick",c,[c.getDuration()])},1e3*+this._.options.tick)),this._.start=+new Date,this._.status="started",this._trigger("onstart",this,[this.getDuration()]),this)):this._end()},b.prototype.pause=function(){return this._.duration-=+new Date-this._.start,this._clear(!1),this._.status="paused",this._trigger("onpause",this),this},b.prototype.stop=function(){return this._clear(!0),this._.status="stopped",this._trigger("onstop",this),this},b.prototype._end=function(){return this._clear(!0),this._.status="finished",this._trigger("onend",this),this},b.prototype._clear=function(a){clearTimeout(this._.timeout),clearInterval(this._.interval),a&&(this._.duration=0)},b.prototype._trigger=function(a,b,c){"function"==typeof this._.options[a]&&this._.options[a].apply(b,c)},b.prototype.getDuration=function(){return"started"!==this._.status?0:Math.round((this._.duration-(+new Date-this._.start))/1e3)},b.prototype.getStatus=function(){return this._.status},b.prototype.options=function(a,b){if(a&&b&&(this._.options[a]=b),!b&&"object"==typeof a)for(var c in a)this._.options.hasOwnProperty(c)&&(this._.options[c]=a[c]);return this},b.prototype.on=function(a,b){return"string"==typeof a&&"function"==typeof b?(/^on/.test(a)||(a="on"+a),this._.options.hasOwnProperty(a)&&(this._.options[a]=b),this):void 0},b.prototype.off=function(b){return"string"==typeof b?(b=b.toLowerCase(),"all"===b?void(this._.options=a):(/^on/.test(b)||(b="on"+b),this._.options.hasOwnProperty(b)&&(this._.options[b]=a[b]),this)):void 0},b.prototype.measureStart=function(a){return this._.measures[a||""]=+new Date,this},b.prototype.measureStop=function(a){return+new Date-this._.measures[a||""]},b});